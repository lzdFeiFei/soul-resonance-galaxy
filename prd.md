# Soul Resonance (灵感共鸣) - 产品需求文档 (PRD)

**版本**: 1.0 (UI/Logic Frozen)  
**日期**: 2025-11-26  
**状态**: 开发完成 / 待接入真实 AI

## 1. 产品概述 (Overview)

**Soul Resonance** 是一个极简主义的、注重情绪与视觉体验的交互式 Web 应用。它旨在捕捉用户瞬间的思绪，通过“共鸣”将其转化为视觉化的星尘，并在虚拟宇宙中寻找回声。

### 核心价值
- **情绪可视化**: 将文字转化为粒子流场与声波动态。
- **孤独感的消解**: 通过“他者星系”与“回声”机制，营造一种“宇宙中总有人在听”的陪伴感。
- **极致的 UI 体验**: 采用液态玻璃、极细线条、动态正弦波等高保真视觉元素。

## 2. 用户流程 (User Flow)

1.  **进入 (Entry)**: 用户进入首页，看到深邃宇宙背景、LOGO 及动态声波。
2.  **输入 (Input)**: 屏幕中央显示输入框，引导用户输入此刻的想法。
3.  **共鸣 (Resonance)**:
    *   用户点击“开始共鸣”。
    *   进入 Loading 阶段（频率扫描、情绪分析）。
    *   展示生成结果（AI 扩写的诗歌/对话 + 动态视觉 + 模拟声波）。
4.  **交互 (Interaction)**:
    *   **重新生成**: 重新运行共鸣流程。
    *   **储存灵感**: 将当前内容转化为一颗粒子，存入“我的星系”，并点亮一个新的“他者星系”。
5.  **探索 (Exploration)**:
    *   视角切换至“星系视图”。
    *   用户可以点击“我的星系”回顾历史。
    *   用户可以点击“他者星系”查看预设的他人灵感（Echo）。
    *   点击“点亮灵感”返回输入首页。

## 3. 功能需求 (Functional Requirements)

### 3.1 首页与输入 (Stage: Input)
- **Header**:
    - 左侧：LOGO (SPARKING SOUL) 及用户元数据 (经纬度/ID)。
    - 右侧：章节名及 **16 根动态竖条声波**。
        - *逻辑*: 声波采用“高-低-高”节奏排列，中间高两边低，金色与灰色交替，动态采用正弦波叠加算法。
- **Input Box**:
    - 半透明磨砂玻璃质感。
    - 引导文案：“开始，让思绪发光...”。
- **Action**: “开始共鸣”按钮，点击触发状态切换。

### 3.2 加载与生成 (Stage: Loading & Result)
- **Loading**: 扫描线动画 + 文字提示 "Parsing emotions..."。
- **Result Display**:
    - **文本区域**: 打字机效果展示 AI 内容（目前为 Mock 数据，分为对话模式和诗歌模式）。
    - **视觉区域**: 
        - 基于 Flow Field (流场) 算法的粒子视频，400 个粒子根据伪噪声函数流动。
        - 底部显示音频波形控件。
    - **Actions**: 
        - “储存灵感”：触发坍缩动画，保存数据。
        - “重新生成”：保留输入文本，重新执行生成流程。

### 3.3 宇宙漫游 (Stage: Galaxy View)
- **我的星系 (My Soul Galaxy)**:
    - 位于屏幕中下方。
    - 包含用户生成的历史粒子。
    - 粒子在星系内根据黄金角度 (Golden Angle) 螺旋排列。
- **他者星系 (Other Galaxies)**:
    - 每次“储存灵感”后，自动在随机位置（避开 UI 禁区）生成一个新的他者星系。
    - 列表联动：左侧列表同步增加一个新的 Soul ID。
    - 交互：点击星系或列表项，摄像机平滑移动聚焦到该星系。
- **避让逻辑**:
    - 生成新星系时，严格避开屏幕底部中央区域（防止遮挡“点亮灵感”按钮）。

### 3.4 回声面板 (Echo Panel)
- **触发**: 点击任意粒子（自己的或他人的）滑出右侧面板。
- **内容**:
    - 顶部：嵌入动态粒子 Canvas (复用流场逻辑)。
    - 中部：展示该粒子的完整文本内容。
        - **滚动条**: 定制化的“液态玻璃”风格 (宽 6px，半透明，磨砂，发光)。
    - 底部：互动按钮 (Resonate / Whisper)。

## 4. 视觉与动画规范 (Visual & Animation)

### 4.1 色彩系统 (Color Palette)
- **背景**: 深空黑 (#050605)
- **主色 (Soul Gold)**: `rgba(210, 190, 160, 0.9)` - 用于高光、主波形。
- **辅色 (Muted Grey)**: `rgba(143, 150, 147, 0.4)` - 用于非活跃波形、次级文字。
- **点缀色**: 极光蓝、甚至粉色（用于粒子）。

### 4.2 关键动画
- **粒子流场**: 使用 `Math.sin` 和 `Math.cos` 组合的 Pseudo-Noise 算法，产生自然的漩涡状流动。
- **头部声波**: 1px 极细线条，5px 间距，遵循严格的节奏比例动态律动。
- **坍缩 (Collapse)**: 保存时，UI 元素缩小并模糊 (`scale(0.92) + blur`)，粒子向中心汇聚。

## 5. 技术栈 (Tech Stack)

- **Core**: HTML5, CSS3 (Flex/Grid, CSS Variables, Backdrop-filter).
- **Logic**: Vanilla JavaScript (ES6+).
- **Rendering**: HTML5 Canvas API (用于粒子系统、声波绘制).
- **External**: Google Fonts (Playfair Display, Noto Serif SC).

## 6. 待办事项 / 未来规划 (Roadmap)

- [ ] **接入真实 LLM**: 对接 OpenAI/Claude API 替换 Mock 文本。
- [ ] **接入 MusicGen**: 根据文本情绪生成真实的音频文件并播放。
- [ ] **持久化存储**: 接入数据库 (Firebase/Supabase) 保存用户的星系数据。
- [ ] **多用户联机**: 在宇宙视图中看到其他实时在线用户的星系。

